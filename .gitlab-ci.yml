stages:
  - deployLocal
  - testArticleService
  - testTopicService
  - testUserService
#  - sonarqube

build:
  stage: deployLocal
  tags: 
    - CI/CD
  script:
    - echo docker compose deployment
    - cd Backend
    - docker compose up 
  when: manual


testArticleService: 
  image: python:3.9-slim-buster
  stage: testArticleService
  tags: 
    - docker_runner
  script:
    - echo "This is test pipepline for article_service"
    - cd Backend/article_service
    - echo $ENV_FILE_ARTICLE_SERVICE
    - cp $ENV_FILE_ARTICLE_SERVICE .env_local
    - pip install -r requirements.txt
    - pytest

testTopicService:
  stage: testTopicService
  tags: 
    - CI/CD
  script:
    - echo "This is test pipepline for topic_service"
    - cd Backend/topic_service
    - cp $ENV_FILE_TOPIC_SERVICE .env_local
    - pip install -r requirements.txt
    - pytest

testUserService:
  stage: testUserService 
  tags: 
    - CI/CD
  script:
    - echo "This is test pipepline for user_service"
    - cd Backend/user_service
    - cp $ENV_FILE_USER_SERVICE .env_local
    - pip install -r requirements.txt
    - pytest





  
